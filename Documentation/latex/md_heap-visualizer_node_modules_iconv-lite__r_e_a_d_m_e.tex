
\begin{DoxyItemize}
\item Doesn\textquotesingle{}t need native code compilation. Works on Windows and in sandboxed environments like \href{http://c9.io}{\texttt{ Cloud9}}.
\item Used in popular projects like \href{https://github.com/expressjs/body-parser}{\texttt{ Express.\+js (body\+\_\+parser)}}, \href{http://gruntjs.com/}{\texttt{ Grunt}}, \href{http://www.nodemailer.com/}{\texttt{ Nodemailer}}, \href{http://yeoman.io/}{\texttt{ Yeoman}} and others.
\item Faster than \href{https://github.com/bnoordhuis/node-iconv}{\texttt{ node-\/iconv}} (see below for performance comparison).
\item Intuitive encode/decode A\+PI
\item Streaming support for \mbox{\hyperlink{class_node}{Node}} v0.\+10+
\item \mbox{[}Deprecated\mbox{]} Can extend Node.\+js primitives (buffers, streams) to support all iconv-\/lite encodings.
\item In-\/browser usage via \href{https://github.com/substack/node-browserify}{\texttt{ Browserify}} ($\sim$180k gzip compressed with Buffer shim included).
\item Typescript \href{https://github.com/ashtuchkin/iconv-lite/blob/master/lib/index.d.ts}{\texttt{ type definition file}} included.
\item React Native is supported (need to explicitly {\ttfamily npm install} two more modules\+: {\ttfamily buffer} and {\ttfamily stream}).
\item License\+: M\+IT.
\end{DoxyItemize}

\href{https://npmjs.org/packages/iconv-lite/}{\texttt{ }}

\doxysection*{Usage}

\doxysubsection*{Basic A\+PI}


\begin{DoxyCode}{0}
\DoxyCodeLine{var iconv = require('iconv-\/lite');}
\DoxyCodeLine{}
\DoxyCodeLine{// Convert from an encoded buffer to js string.}
\DoxyCodeLine{str = iconv.decode(Buffer.from([0x68, 0x65, 0x6c, 0x6c, 0x6f]), 'win1251');}
\DoxyCodeLine{}
\DoxyCodeLine{// Convert from js string to an encoded buffer.}
\DoxyCodeLine{buf = iconv.encode("Sample input string", 'win1251');}
\DoxyCodeLine{}
\DoxyCodeLine{// Check if encoding is supported}
\DoxyCodeLine{iconv.encodingExists("us-\/ascii")}
\end{DoxyCode}


\doxysubsection*{Streaming A\+PI (\mbox{\hyperlink{class_node}{Node}} v0.\+10+)}


\begin{DoxyCode}{0}
\DoxyCodeLine{// Decode stream (from binary stream to js strings)}
\DoxyCodeLine{http.createServer(function(req, res) \{}
\DoxyCodeLine{    var converterStream = iconv.decodeStream('win1251');}
\DoxyCodeLine{    req.pipe(converterStream);}
\DoxyCodeLine{}
\DoxyCodeLine{    converterStream.on('data', function(str) \{}
\DoxyCodeLine{        console.log(str); // Do something with decoded strings, chunk-\/by-\/chunk.}
\DoxyCodeLine{    \});}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{// Convert encoding streaming example}
\DoxyCodeLine{fs.createReadStream('file-\/in-\/win1251.txt')}
\DoxyCodeLine{    .pipe(iconv.decodeStream('win1251'))}
\DoxyCodeLine{    .pipe(iconv.encodeStream('ucs2'))}
\DoxyCodeLine{    .pipe(fs.createWriteStream('file-\/in-\/ucs2.txt'));}
\DoxyCodeLine{}
\DoxyCodeLine{// Sugar: all encode/decode streams have .collect(cb) method to accumulate data.}
\DoxyCodeLine{http.createServer(function(req, res) \{}
\DoxyCodeLine{    req.pipe(iconv.decodeStream('win1251')).collect(function(err, body) \{}
\DoxyCodeLine{        assert(typeof body == 'string');}
\DoxyCodeLine{        console.log(body); // full request body string}
\DoxyCodeLine{    \});}
\DoxyCodeLine{\});}
\end{DoxyCode}


\doxysubsection*{\mbox{[}Deprecated\mbox{]} Extend Node.\+js own encodings}

\begin{quote}
N\+O\+TE\+: This doesn\textquotesingle{}t work on latest \mbox{\hyperlink{class_node}{Node}} versions. See \href{https://github.com/ashtuchkin/iconv-lite/wiki/Node-v4-compatibility}{\texttt{ details}}. \end{quote}



\begin{DoxyCode}{0}
\DoxyCodeLine{// After this call all Node basic primitives will understand iconv-\/lite encodings.}
\DoxyCodeLine{iconv.extendNodeEncodings();}
\DoxyCodeLine{}
\DoxyCodeLine{// Examples:}
\DoxyCodeLine{buf = new Buffer(str, 'win1251');}
\DoxyCodeLine{buf.write(str, 'gbk');}
\DoxyCodeLine{str = buf.toString('latin1');}
\DoxyCodeLine{assert(Buffer.isEncoding('iso-\/8859-\/15'));}
\DoxyCodeLine{Buffer.byteLength(str, 'us-\/ascii');}
\DoxyCodeLine{}
\DoxyCodeLine{http.createServer(function(req, res) \{}
\DoxyCodeLine{    req.setEncoding('big5');}
\DoxyCodeLine{    req.collect(function(err, body) \{}
\DoxyCodeLine{        console.log(body);}
\DoxyCodeLine{    \});}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{fs.createReadStream("file.txt", "shift\_jis");}
\DoxyCodeLine{}
\DoxyCodeLine{// External modules are also supported (if they use Node primitives, which they probably do).}
\DoxyCodeLine{request = require('request');}
\DoxyCodeLine{request(\{}
\DoxyCodeLine{    url: "http://github.com/", }
\DoxyCodeLine{    encoding: "cp932"}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{// To remove extensions}
\DoxyCodeLine{iconv.undoExtendNodeEncodings();}
\end{DoxyCode}


\doxysection*{Supported encodings}


\begin{DoxyItemize}
\item All node.\+js native encodings\+: utf8, ucs2 / utf16-\/le, ascii, binary, base64, hex.
\item Additional unicode encodings\+: utf16, utf16-\/be, utf-\/7, utf-\/7-\/imap.
\item All widespread singlebyte encodings\+: Windows 125x family, I\+S\+O-\/8859 family, I\+B\+M/\+D\+OS codepages, Macintosh family, K\+O\+I8 family, all others supported by iconv library. Aliases like \textquotesingle{}latin1\textquotesingle{}, \textquotesingle{}us-\/ascii\textquotesingle{} also supported.
\item All widespread multibyte encodings\+: C\+P932, C\+P936, C\+P949, C\+P950, G\+B2312, G\+BK, G\+B18030, Big5, Shift\+\_\+\+J\+IS, E\+U\+C-\/\+JP.
\end{DoxyItemize}

See \href{https://github.com/ashtuchkin/iconv-lite/wiki/Supported-Encodings}{\texttt{ all supported encodings on wiki}}.

Most singlebyte encodings are generated automatically from \href{https://github.com/bnoordhuis/node-iconv}{\texttt{ node-\/iconv}}. Thank you Ben Noordhuis and libiconv authors!

Multibyte encodings are generated from \href{http://www.unicode.org/Public/MAPPINGS/}{\texttt{ Unicode.\+org mappings}} and \href{http://encoding.spec.whatwg.org/}{\texttt{ W\+H\+A\+T\+WG Encoding Standard mappings}}. Thank you, respective authors!

\doxysection*{Encoding/decoding speed}

Comparison with node-\/iconv module (1000x256kb, on Mac\+Book Pro, Core i5/2.\+6 G\+Hz, \mbox{\hyperlink{class_node}{Node}} v0.\+12.\+0). Note\+: your results may vary, so please always check on your hardware. \begin{DoxyVerb}operation             iconv@2.1.4   iconv-lite@0.4.7
----------------------------------------------------------
encode('win1251')     ~96 Mb/s      ~320 Mb/s
decode('win1251')     ~95 Mb/s      ~246 Mb/s
\end{DoxyVerb}


\doxysection*{B\+OM handling}


\begin{DoxyItemize}
\item Decoding\+: B\+OM is stripped by default, unless overridden by passing {\ttfamily strip\+B\+OM\+: false} in options (f.\+ex. {\ttfamily iconv.\+decode(buf, enc, \{strip\+B\+OM\+: false\})}). A callback might also be given as a {\ttfamily strip\+B\+OM} parameter -\/ it\textquotesingle{}ll be called if B\+OM character was actually found.
\item If you want to detect U\+T\+F-\/8 B\+OM when decoding other encodings, use \href{https://github.com/danielgindi/node-autodetect-decoder-stream}{\texttt{ node-\/autodetect-\/decoder-\/stream}} module.
\item Encoding\+: No B\+OM added, unless overridden by {\ttfamily add\+B\+OM\+: true} option.
\end{DoxyItemize}

\doxysection*{U\+T\+F-\/16 Encodings}

This library supports U\+T\+F-\/16\+LE, U\+T\+F-\/16\+BE and U\+T\+F-\/16 encodings. First two are straightforward, but U\+T\+F-\/16 is trying to be smart about endianness in the following ways\+:
\begin{DoxyItemize}
\item Decoding\+: uses B\+OM and \textquotesingle{}spaces heuristic\textquotesingle{} to determine input endianness. Default is U\+T\+F-\/16\+LE, but can be overridden with `default\+Encoding\+: \textquotesingle{}utf-\/16be'{\ttfamily option. Strips B\+OM unless}strip\+B\+OM\+: false{\ttfamily .}
\item {\ttfamily Encoding\+: uses U\+T\+F-\/16\+LE and writes B\+OM by default. Use}add\+B\+OM\+: false\`{} to override.
\end{DoxyItemize}

\doxysection*{Other notes}

When decoding, be sure to supply a Buffer to decode() method, otherwise \href{https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding}{\texttt{ bad things usually happen}}. ~\newline
 Untranslatable characters are set to {\ucr} or ?. No transliteration is currently supported. ~\newline
 \mbox{\hyperlink{class_node}{Node}} versions 0.\+10.\+31 and 0.\+11.\+13 are buggy, don\textquotesingle{}t use them (see \#65, \#77). ~\newline


\doxysection*{Testing}


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ git clone git@github.com:ashtuchkin/iconv-\/lite.git}
\DoxyCodeLine{\$ cd iconv-\/lite}
\DoxyCodeLine{\$ npm install}
\DoxyCodeLine{\$ npm test}
\DoxyCodeLine{    }
\DoxyCodeLine{\$ \# To view performance:}
\DoxyCodeLine{\$ node test/performance.js}
\DoxyCodeLine{}
\DoxyCodeLine{\$ \# To view test coverage:}
\DoxyCodeLine{\$ npm run coverage}
\DoxyCodeLine{\$ open coverage/lcov-\/report/index.html}
\end{DoxyCode}
 