\doxysection*{vscode-\/test}



\href{https://dev.azure.com/vscode/vscode-test/_build?definitionId=15}{\texttt{  }} \href{https://travis-ci.org/microsoft/vscode-test}{\texttt{  }} 

This module helps you test VS Code extensions.

Supported\+:


\begin{DoxyItemize}
\item \mbox{\hyperlink{class_node}{Node}} $>$= 8.\+x
\item Windows $>$= Windows Server 2012+ / Win10+ (anything with Powershell $>$= 5.\+0)
\item mac\+OS
\item Linux
\end{DoxyItemize}

\doxysubsection*{Usage}

See \href{./sample}{\texttt{ ./sample}} for a runnable sample, with \href{https://github.com/microsoft/vscode-test/blob/master/sample/azure-pipelines.yml}{\texttt{ Azure Dev\+Ops Pipelines}} and \href{https://github.com/microsoft/vscode-test/blob/master/.travis.yml}{\texttt{ Travis CI}} configuration.


\begin{DoxyCode}{0}
\DoxyCodeLine{async function go() \{}
\DoxyCodeLine{    try \{}
\DoxyCodeLine{        const extensionDevelopmentPath = path.resolve(\_\_dirname, '../../../')}
\DoxyCodeLine{        const extensionTestsPath = path.resolve(\_\_dirname, './suite')}
\DoxyCodeLine{}
\DoxyCodeLine{        /**}
\DoxyCodeLine{         * Basic usage}
\DoxyCodeLine{         */}
\DoxyCodeLine{        await runTests(\{}
\DoxyCodeLine{            extensionDevelopmentPath,}
\DoxyCodeLine{            extensionTestsPath}
\DoxyCodeLine{        \})}
\DoxyCodeLine{}
\DoxyCodeLine{        const extensionTestsPath2 = path.resolve(\_\_dirname, './suite2')}
\DoxyCodeLine{        const testWorkspace = path.resolve(\_\_dirname, '../../../test-\/fixtures/fixture1')}
\DoxyCodeLine{}
\DoxyCodeLine{        /**}
\DoxyCodeLine{         * Running another test suite on a specific workspace}
\DoxyCodeLine{         */}
\DoxyCodeLine{        await runTests(\{}
\DoxyCodeLine{            extensionDevelopmentPath,}
\DoxyCodeLine{            extensionTestsPath: extensionTestsPath2,}
\DoxyCodeLine{            launchArgs: [testWorkspace]}
\DoxyCodeLine{        \})}
\DoxyCodeLine{}
\DoxyCodeLine{        /**}
\DoxyCodeLine{         * Use 1.36.1 release for testing}
\DoxyCodeLine{         */}
\DoxyCodeLine{        await runTests(\{}
\DoxyCodeLine{            version: '1.36.1',}
\DoxyCodeLine{            extensionDevelopmentPath,}
\DoxyCodeLine{            extensionTestsPath,}
\DoxyCodeLine{            launchArgs: [testWorkspace]}
\DoxyCodeLine{        \})}
\DoxyCodeLine{}
\DoxyCodeLine{        /**}
\DoxyCodeLine{         * Use Insiders release for testing}
\DoxyCodeLine{         */}
\DoxyCodeLine{        await runTests(\{}
\DoxyCodeLine{            version: 'insiders',}
\DoxyCodeLine{            extensionDevelopmentPath,}
\DoxyCodeLine{            extensionTestsPath,}
\DoxyCodeLine{            launchArgs: [testWorkspace]}
\DoxyCodeLine{        \})}
\DoxyCodeLine{}
\DoxyCodeLine{        /**}
\DoxyCodeLine{         * Noop, since 1.36.1 already downloaded to .vscode-\/test/vscode-\/1.36.1}
\DoxyCodeLine{         */}
\DoxyCodeLine{        await downloadAndUnzipVSCode('1.36.1')}
\DoxyCodeLine{}
\DoxyCodeLine{        /**}
\DoxyCodeLine{         * Manually download VS Code 1.35.0 release for testing.}
\DoxyCodeLine{         */}
\DoxyCodeLine{        const vscodeExecutablePath = await downloadAndUnzipVSCode('1.35.0')}
\DoxyCodeLine{        await runTests(\{}
\DoxyCodeLine{            vscodeExecutablePath,}
\DoxyCodeLine{            extensionDevelopmentPath,}
\DoxyCodeLine{            extensionTestsPath,}
\DoxyCodeLine{            launchArgs: [testWorkspace]}
\DoxyCodeLine{        \})}
\DoxyCodeLine{}
\DoxyCodeLine{        /**}
\DoxyCodeLine{         * Install Python extension}
\DoxyCodeLine{         */}
\DoxyCodeLine{        const cliPath = resolveCliPathFromVSCodeExecutablePath(vscodeExecutablePath)}
\DoxyCodeLine{        cp.spawnSync(cliPath, ['-\/-\/install-\/extension', 'ms-\/python.python'], \{}
\DoxyCodeLine{            encoding: 'utf-\/8',}
\DoxyCodeLine{            stdio: 'inherit'}
\DoxyCodeLine{        \})}
\DoxyCodeLine{}
\DoxyCodeLine{        /**}
\DoxyCodeLine{         * -\/ Add additional launch flags for VS Code}
\DoxyCodeLine{         * -\/ Pass custom environment variables to test runner}
\DoxyCodeLine{         */}
\DoxyCodeLine{        await runTests(\{}
\DoxyCodeLine{            vscodeExecutablePath,}
\DoxyCodeLine{            extensionDevelopmentPath,}
\DoxyCodeLine{            extensionTestsPath,}
\DoxyCodeLine{            launchArgs: [}
\DoxyCodeLine{                testWorkspace,}
\DoxyCodeLine{                // This disables all extensions except the one being testing}
\DoxyCodeLine{                '-\/-\/disable-\/extensions'}
\DoxyCodeLine{            ],}
\DoxyCodeLine{            // Custom environment variables for extension test script}
\DoxyCodeLine{            extensionTestsEnv: \{ foo: 'bar' \}}
\DoxyCodeLine{        \})}
\DoxyCodeLine{}
\DoxyCodeLine{        /**}
\DoxyCodeLine{         * Use win64 instead of win32 for testing Windows}
\DoxyCodeLine{         */}
\DoxyCodeLine{        if (process.platform === 'win32') \{}
\DoxyCodeLine{            await runTests(\{}
\DoxyCodeLine{                extensionDevelopmentPath,}
\DoxyCodeLine{                extensionTestsPath,}
\DoxyCodeLine{                version: '1.40.0',}
\DoxyCodeLine{                platform: 'win32-\/x64-\/archive'}
\DoxyCodeLine{            \});}
\DoxyCodeLine{        \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \} catch (err) \{}
\DoxyCodeLine{        console.error('Failed to run tests')}
\DoxyCodeLine{        process.exit(1)}
\DoxyCodeLine{    \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{go()}
\end{DoxyCode}


\doxysubsection*{License}

\mbox{[}M\+IT\mbox{]}(L\+I\+C\+E\+N\+SE)

\doxysubsection*{Contributing}

This project welcomes contributions and suggestions. Most contributions require you to agree to a Contributor License Agreement (C\+LA) declaring that you have the right to, and actually do, grant us the rights to use your contribution. For details, visit \href{https://cla.microsoft.com}{\texttt{ https\+://cla.\+microsoft.\+com}}.

When you submit a pull request, a C\+L\+A-\/bot will automatically determine whether you need to provide a C\+LA and decorate the PR appropriately (e.\+g., label, comment). Simply follow the instructions provided by the bot. You will only need to do this once across all repos using our C\+LA.

This project has adopted the \href{https://opensource.microsoft.com/codeofconduct/}{\texttt{ Microsoft Open Source Code of Conduct}}. For more information see the \href{https://opensource.microsoft.com/codeofconduct/faq/}{\texttt{ Code of Conduct F\+AQ}} or contact \href{mailto:opencode@microsoft.com}{\texttt{ opencode@microsoft.\+com}} with any additional questions or comments. 