\href{https://travis-ci.org/zertosh/v8-compile-cache}{\texttt{ }}

{\ttfamily v8-\/compile-\/cache} attaches a {\ttfamily require} hook to use \href{https://v8project.blogspot.com/2015/07/code-caching.html}{\texttt{ V8\textquotesingle{}s code cache}} to speed up instantiation time. The \char`\"{}code cache\char`\"{} is the work of parsing and compiling done by V8.

The ability to tap into V8 to produce/consume this cache was introduced in \href{https://nodejs.org/en/blog/release/v5.7.0/}{\texttt{ Node v5.\+7.\+0}}.

\doxysection*{Usage}


\begin{DoxyEnumerate}
\item Add the dependency\+:
\end{DoxyEnumerate}


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ npm install -\/-\/save v8-\/compile-\/cache}
\end{DoxyCode}



\begin{DoxyEnumerate}
\item Then, in your entry module add\+:
\end{DoxyEnumerate}


\begin{DoxyCode}{0}
\DoxyCodeLine{require('v8-\/compile-\/cache');}
\end{DoxyCode}


{\bfseries{Requiring {\ttfamily v8-\/compile-\/cache} in \mbox{\hyperlink{class_node}{Node}} $<$5.\+7.\+0 is a noop â€“ but you need at least \mbox{\hyperlink{class_node}{Node}} 4.\+0.\+0 to support the E\+S2015 syntax used by {\ttfamily v8-\/compile-\/cache}.}}

\doxysection*{Options}

Set the environment variable {\ttfamily D\+I\+S\+A\+B\+L\+E\+\_\+\+V8\+\_\+\+C\+O\+M\+P\+I\+L\+E\+\_\+\+C\+A\+C\+HE=1} to disable the cache.

\doxysection*{Internals}

The caches are stored in {\ttfamily \$\+T\+MP/v8-\/compile-\/cache/\+V8\+\_\+\+V\+E\+R\+S\+I\+ON}, where there are {\ttfamily .B\+L\+OB} and {\ttfamily .M\+AP} files corresponding to the entry module that required {\ttfamily v8-\/compile-\/cache}. The cache is {\itshape entry module specific} because it is faster to load the entire code cache into memory at once, than it is to read it from disk on a file-\/by-\/file basis.

\doxysection*{Benchmarks}

See \href{https://github.com/zertosh/v8-compile-cache/tree/master/bench}{\texttt{ https\+://github.\+com/zertosh/v8-\/compile-\/cache/tree/master/bench}}.

{\bfseries{Load Times\+:}}

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Module }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ Without Cache }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ With Cache  }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Module }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ Without Cache }&\PBS\raggedleft \cellcolor{\tableheadbgcolor}\textbf{ With Cache  }\\\cline{1-3}
\endhead
{\ttfamily babel-\/core} &\PBS\raggedleft {\ttfamily 218ms} &\PBS\raggedleft {\ttfamily 185ms}  \\\cline{1-3}
{\ttfamily yarn} &\PBS\raggedleft {\ttfamily 153ms} &\PBS\raggedleft {\ttfamily 113ms}  \\\cline{1-3}
{\ttfamily yarn} (bundled) &\PBS\raggedleft {\ttfamily 228ms} &\PBS\raggedleft {\ttfamily 105ms}  \\\cline{1-3}
\end{longtabu}


\+\_\+$^\wedge$ Includes the overhead of loading the cache itself.\+\_\+

\doxysection*{Acknowledgements}


\begin{DoxyItemize}
\item {\ttfamily File\+System\+Blob\+Store} and {\ttfamily Native\+Compile\+Cache} are based on Atom\textquotesingle{}s implementation of their v8 compile cache\+:
\begin{DoxyItemize}
\item \href{https://github.com/atom/atom/blob/b0d7a8a/src/file-system-blob-store.js}{\texttt{ https\+://github.\+com/atom/atom/blob/b0d7a8a/src/file-\/system-\/blob-\/store.\+js}}
\item \href{https://github.com/atom/atom/blob/b0d7a8a/src/native-compile-cache.js}{\texttt{ https\+://github.\+com/atom/atom/blob/b0d7a8a/src/native-\/compile-\/cache.\+js}}
\end{DoxyItemize}
\item {\ttfamily mkdirp\+Sync} is based on\+:
\begin{DoxyItemize}
\item \href{https://github.com/substack/node-mkdirp/blob/f2003bb/index.js\#L55-L98}{\texttt{ https\+://github.\+com/substack/node-\/mkdirp/blob/f2003bb/index.\+js\#\+L55-\/\+L98}} 
\end{DoxyItemize}
\end{DoxyItemize}